<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FreeClaw - Set Up OpenClaw in 10 Minutes</title>
  <meta name="description" content="Set up your own AI chatbot on Telegram, Discord, WhatsApp, or Slack. No coding required. 100% free, runs locally. Powered by OpenClaw.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><text y='28' font-size='28'>ðŸ¦ž</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #0a0a0f;
  --card: rgba(255, 255, 255, 0.03);
  --card-border: rgba(255, 255, 255, 0.08);
  --card-hover: rgba(255, 255, 255, 0.06);
  --text: #ffffff;
  --text-soft: rgba(255, 255, 255, 0.7);
  --text-muted: rgba(255, 255, 255, 0.4);
  --accent-solid: #a855f7;
  --accent-blue: #3b82f6;
  --accent-indigo: #6366f1;
  --accent-green: #10b981;
  --accent-red: #ef4444;
  --accent-yellow: #eab308;
  --glass: rgba(255, 255, 255, 0.04);
  --glass-border: rgba(255, 255, 255, 0.1);
  --radius: 16px;
  --radius-sm: 10px;
  --radius-lg: 20px;
  --font: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --transition: 0.2s cubic-bezier(.4,0,.2,1);
}

html { scroll-behavior: smooth; }

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  min-height: 100vh;
  overflow-x: hidden;
  line-height: 1.6;
}

/* Animated orbs background */
.ambient {
  position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden;
}
.orb {
  position: absolute;
  border-radius: 50%;
  filter: blur(120px);
  opacity: 0.15;
  animation: float 20s ease-in-out infinite;
}
.orb-1 {
  width: 600px; height: 600px;
  background: #a855f7;
  top: -20%; left: -10%;
  animation-delay: 0s;
}
.orb-2 {
  width: 500px; height: 500px;
  background: #3b82f6;
  bottom: -15%; right: -10%;
  animation-delay: -7s;
}
.orb-3 {
  width: 400px; height: 400px;
  background: #ec4899;
  top: 40%; right: 20%;
  animation-delay: -14s;
}
@keyframes float {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(30px, -40px) scale(1.05); }
  66% { transform: translate(-20px, 30px) scale(0.95); }
}

/* Nav */
.nav {
  position: relative; z-index: 10;
  display: flex; align-items: center; justify-content: space-between;
  max-width: 720px;
  margin: 0 auto;
  padding: 1.5rem 1.5rem 0;
}
.nav-logo {
  font-size: 1.2rem; font-weight: 700; color: var(--text);
  text-decoration: none; display: flex; align-items: center; gap: 0.5rem;
}
.nav-badge {
  font-size: 0.7rem; color: var(--text-muted);
  background: var(--glass);
  border: 1px solid var(--glass-border);
  padding: 0.2rem 0.6rem;
  border-radius: 999px;
  text-decoration: none;
  transition: color var(--transition);
}
.nav-badge:hover { color: var(--text-soft); }
.nav-links { display: flex; gap: 1.25rem; }
.nav-links a {
  font-size: 0.85rem; color: var(--text-muted);
  text-decoration: none; transition: color var(--transition);
}
.nav-links a:hover { color: var(--text); }

/* Layout */
.container {
  position: relative; z-index: 1;
  max-width: 720px;
  margin: 0 auto;
  padding: 2rem 1.5rem 4rem;
}

/* Landing */
.landing { text-align: center; padding-top: 3rem; }
.landing-badge {
  display: inline-block;
  font-size: 0.75rem; font-weight: 500;
  color: var(--accent-solid);
  background: rgba(168, 85, 247, 0.1);
  border: 1px solid rgba(168, 85, 247, 0.2);
  padding: 0.35rem 1rem;
  border-radius: 999px;
  margin-bottom: 1.5rem;
}
.landing h1 {
  font-size: 2.75rem; font-weight: 700;
  letter-spacing: -0.03em; line-height: 1.15;
  margin-bottom: 1rem;
}
@media (max-width: 600px) { .landing h1 { font-size: 2rem; } }
.gradient-text {
  background: linear-gradient(135deg, #a855f7 0%, #6366f1 50%, #3b82f6 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}
.landing-sub {
  color: var(--text-soft);
  font-size: 1.1rem; line-height: 1.6;
  max-width: 520px; margin: 0 auto 2rem;
}

/* Warning card */
.warning-card {
  background: rgba(234, 179, 8, 0.05);
  border: 1px solid rgba(234, 179, 8, 0.15);
  border-radius: var(--radius);
  padding: 1.25rem 1.5rem;
  text-align: left;
  margin-bottom: 1.5rem;
}
.warning-card-title {
  font-size: 0.85rem; font-weight: 600; color: var(--accent-yellow);
  margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;
}
.warning-card p {
  font-size: 0.85rem; color: var(--text-soft); line-height: 1.6;
}
.warning-card a { color: var(--accent-solid); text-decoration: none; }
.warning-card a:hover { text-decoration: underline; }

/* Disclaimer checkbox */
.disclaimer-check {
  display: flex; align-items: flex-start; gap: 0.75rem;
  margin-bottom: 1.5rem;
  text-align: left;
  cursor: pointer;
}
.disclaimer-check input[type="checkbox"] {
  width: 18px; height: 18px; margin-top: 2px;
  accent-color: var(--accent-solid);
  cursor: pointer; flex-shrink: 0;
}
.disclaimer-check label {
  font-size: 0.85rem; color: var(--text-soft); cursor: pointer; line-height: 1.5;
}

/* CTA button */
.cta {
  display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
  padding: 0.9rem 2.5rem;
  background: linear-gradient(135deg, var(--accent-solid), var(--accent-indigo), var(--accent-blue));
  color: #fff; font-family: var(--font); font-size: 1rem; font-weight: 600;
  border: none; border-radius: var(--radius);
  cursor: pointer; transition: all var(--transition);
  box-shadow: 0 0 30px rgba(168, 85, 247, 0.2), inset 0 1px 0 rgba(255,255,255,0.15);
}
.cta:hover { box-shadow: 0 0 40px rgba(168, 85, 247, 0.35), inset 0 1px 0 rgba(255,255,255,0.2); transform: translateY(-2px); }
.cta:disabled { opacity: 0.35; cursor: not-allowed; transform: none; box-shadow: none; }

/* Info card */
.info-card {
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 1.25rem 1.5rem;
  margin-top: 2rem;
  text-align: left;
}
.info-card p { font-size: 0.85rem; color: var(--text-muted); line-height: 1.6; }
.info-card a { color: var(--accent-solid); text-decoration: none; }
.info-card a:hover { text-decoration: underline; }

/* Progress bar */
.progress-wrap {
  margin-bottom: 2rem;
}
.progress-bar {
  width: 100%; height: 4px;
  background: rgba(255,255,255,0.06);
  border-radius: 2px; overflow: hidden;
  margin-bottom: 0.5rem;
}
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent-solid), var(--accent-blue));
  border-radius: 2px;
  transition: width 0.4s ease;
  width: 0%;
}
.progress-labels {
  display: flex; justify-content: space-between;
  font-size: 0.7rem; color: var(--text-muted);
}
.progress-labels span { transition: color var(--transition); }
.progress-labels span.active { color: var(--accent-solid); font-weight: 600; }
.progress-labels span.done { color: var(--accent-green); }

/* Steps */
.wizard { display: none; }
.wizard.active { display: block; }
.step { display: none; animation: fadeIn 0.35s ease; }
.step.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: none; } }

.step-head {
  font-size: 1.75rem; font-weight: 700; letter-spacing: -0.02em;
  margin-bottom: 0.5rem;
}
.step-sub {
  color: var(--text-soft); font-size: 1rem; margin-bottom: 2rem; line-height: 1.5;
}

/* Back arrow */
.back-arrow {
  display: inline-flex; align-items: center; gap: 0.4rem;
  background: none; border: none; color: var(--text-muted);
  font-family: var(--font); font-size: 0.85rem;
  cursor: pointer; padding: 0.5rem 0; margin-bottom: 1rem;
  transition: color var(--transition);
}
.back-arrow:hover { color: var(--text); }

/* Cards */
.card {
  background: var(--glass);
  border: 1px solid var(--card-border);
  border-radius: var(--radius);
  padding: 1.25rem;
  transition: all var(--transition);
  cursor: pointer;
  position: relative;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.card:hover { background: var(--card-hover); border-color: var(--glass-border); }
.card.selected {
  border-color: var(--accent-solid);
  background: rgba(168, 85, 247, 0.08);
  box-shadow: 0 0 0 1px var(--accent-solid), 0 0 20px rgba(168, 85, 247, 0.1);
}
.card-check {
  position: absolute; top: 0.75rem; right: 0.75rem;
  width: 22px; height: 22px; border-radius: 50%;
  border: 2px solid var(--card-border);
  display: flex; align-items: center; justify-content: center;
  transition: all var(--transition);
}
.card.selected .card-check {
  border-color: var(--accent-solid); background: var(--accent-solid);
}
.card.selected .card-check svg { opacity: 1; }
.card-check svg { opacity: 0; transition: opacity var(--transition); }
.card-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1.5rem; }
@media (max-width: 500px) { .card-grid { grid-template-columns: 1fr; } }
.card-icon { width: 36px; height: 36px; margin-bottom: 0.75rem; color: var(--text-soft); }
.card-title { font-weight: 600; font-size: 0.95rem; margin-bottom: 0.25rem; }
.card-desc { font-size: 0.8rem; color: var(--text-muted); }
.card .rec-tag {
  position: absolute; top: 0.75rem; left: 0.75rem;
  font-size: 0.6rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em;
  padding: 0.2rem 0.5rem; border-radius: 4px;
  background: rgba(168, 85, 247, 0.15); color: #c084fc;
}

/* Model cards - 3 column */
.card-grid.three { grid-template-columns: 1fr 1fr 1fr; }
@media (max-width: 500px) { .card-grid.three { grid-template-columns: 1fr; } }

/* API key modal */
.api-modal-overlay {
  display: none; position: fixed; inset: 0; z-index: 200;
  background: rgba(0,0,0,0.6); backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  justify-content: center; align-items: center;
}
.api-modal-overlay.open { display: flex; }
.api-modal {
  background: #12121a; border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg); padding: 2rem;
  max-width: 520px; width: 90%;
  max-height: 85vh; overflow-y: auto;
  animation: fadeIn 0.25s ease;
}
.api-modal h3 { font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem; }
.api-modal-close {
  float: right; background: none; border: none; color: var(--text-muted);
  cursor: pointer; font-size: 1.5rem; line-height: 1; margin-top: -0.5rem;
}
.api-modal-close:hover { color: var(--text); }

/* Input fields */
.form-row { margin-bottom: 1.25rem; }
.form-label { display: block; font-size: 0.82rem; font-weight: 500; margin-bottom: 0.4rem; color: var(--text-soft); }
.form-input {
  width: 100%;
  padding: 0.75rem 1rem;
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--card-border);
  border-radius: var(--radius-sm);
  color: var(--text); font-family: var(--font); font-size: 0.9rem;
  outline: none; transition: border-color var(--transition);
}
.form-input:focus { border-color: var(--accent-solid); box-shadow: 0 0 0 2px rgba(168,85,247,0.15); }
.form-input::placeholder { color: var(--text-muted); }
textarea.form-input { min-height: 80px; resize: vertical; line-height: 1.5; }
.form-hint { font-size: 0.75rem; color: var(--text-muted); margin-top: 0.3rem; }
.form-error { font-size: 0.75rem; color: var(--accent-red); margin-top: 0.3rem; display: none; }
.form-success { font-size: 0.75rem; color: var(--accent-green); margin-top: 0.3rem; display: none; }

/* Input with toggle button */
.input-wrap {
  position: relative; display: flex; align-items: center;
  background: rgba(255,255,255,0.04);
  border: 1px solid var(--card-border);
  border-radius: var(--radius-sm);
  transition: border-color var(--transition);
}
.input-wrap:focus-within { border-color: var(--accent-solid); box-shadow: 0 0 0 2px rgba(168,85,247,0.15); }
.input-wrap input {
  flex: 1; width: 100%; padding: 0.75rem 1rem;
  background: none; border: none; outline: none;
  color: var(--text); font-family: var(--font); font-size: 0.9rem;
}
.input-wrap input::placeholder { color: var(--text-muted); }
.api-toggle {
  padding: 0.5rem 0.75rem; background: none; border: none;
  cursor: pointer; color: var(--text-muted); display: flex; align-items: center;
}
.api-toggle:hover { color: var(--text-soft); }

/* Guide link */
.guide-link {
  display: inline-flex; align-items: center; gap: 0.4rem;
  font-size: 0.82rem; color: var(--accent-solid);
  background: none; border: none; cursor: pointer;
  font-family: var(--font); text-decoration: none;
  margin-top: 0.5rem;
}
.guide-link:hover { text-decoration: underline; }

/* Style chips */
.chips { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.25rem; }
.chip {
  padding: 0.5rem 1rem;
  background: var(--glass);
  border: 1px solid var(--card-border);
  border-radius: 999px;
  color: var(--text-soft);
  font-family: var(--font); font-size: 0.85rem;
  cursor: pointer; transition: all var(--transition);
}
.chip:hover { border-color: var(--glass-border); color: var(--text); }
.chip.selected {
  border-color: var(--accent-solid); color: var(--accent-solid);
  background: rgba(168, 85, 247, 0.1);
}

/* Setup guide visual */
.setup-box {
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.setup-box h3 { font-size: 1rem; font-weight: 600; margin-bottom: 1rem; }

/* Numbered guide steps */
.guide-steps { list-style: none; counter-reset: guide; margin: 0; padding: 0; }
.guide-steps li {
  counter-increment: guide;
  padding: 0.6rem 0 0.6rem 2.75rem;
  position: relative;
  font-size: 0.88rem; color: var(--text-soft); line-height: 1.6;
}
.guide-steps li::before {
  content: counter(guide);
  position: absolute; left: 0; top: 0.5rem;
  width: 1.75rem; height: 1.75rem;
  background: rgba(168, 85, 247, 0.12); color: #c084fc;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.75rem; font-weight: 600;
}
.guide-steps li code {
  background: rgba(255,255,255,0.06); padding: 0.15rem 0.5rem;
  border-radius: 4px; font-size: 0.82rem; font-family: 'SF Mono', 'Fira Code', monospace;
}
.guide-steps a { color: var(--accent-solid); text-decoration: none; }
.guide-steps a:hover { text-decoration: underline; }

/* FAQ */
.faq-section { margin-top: 1.5rem; }
.faq-item { border-bottom: 1px solid var(--card-border); }
.faq-q {
  display: flex; justify-content: space-between; align-items: center;
  padding: 0.85rem 0; cursor: pointer;
  font-size: 0.88rem; font-weight: 500; color: var(--text);
}
.faq-q:hover { color: var(--accent-solid); }
.faq-q svg { flex-shrink: 0; transition: transform var(--transition); }
.faq-q.open svg { transform: rotate(180deg); }
.faq-a {
  display: none; padding: 0 0 0.85rem;
  font-size: 0.82rem; color: var(--text-soft); line-height: 1.6;
}
.faq-a.open { display: block; }

/* Download section */
.dl-box {
  text-align: center;
  padding: 2.5rem;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  margin: 1.5rem 0;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
.dl-box .dl-label { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 1rem; }

/* Copy command for Mac */
.terminal-cmd {
  background: #1a1a2e;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: var(--radius-sm);
  padding: 1rem 1.25rem;
  text-align: left; margin-bottom: 1rem;
  font-family: 'SF Mono', 'Fira Code', monospace;
  font-size: 0.82rem; color: #4ade80;
  word-break: break-all;
  position: relative;
}
.copy-btn {
  display: inline-flex; align-items: center; gap: 0.5rem;
  padding: 0.7rem 1.5rem;
  background: linear-gradient(135deg, var(--accent-solid), var(--accent-indigo));
  color: #fff; font-family: var(--font); font-size: 0.9rem; font-weight: 500;
  border: none; border-radius: var(--radius-sm);
  cursor: pointer; transition: all var(--transition);
}
.copy-btn:hover { transform: translateY(-1px); box-shadow: 0 0 20px rgba(168,85,247,0.25); }

.dl-btn {
  display: inline-flex; align-items: center; gap: 0.5rem;
  padding: 0.9rem 2rem;
  background: linear-gradient(135deg, var(--accent-solid), var(--accent-indigo));
  color: #fff; font-family: var(--font); font-size: 1rem; font-weight: 600;
  border: none; border-radius: var(--radius);
  cursor: pointer; transition: all var(--transition);
  box-shadow: 0 0 20px rgba(168,85,247,0.15);
}
.dl-btn:hover { transform: translateY(-2px); box-shadow: 0 0 30px rgba(168,85,247,0.3); }
.dl-note { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.75rem; }

/* Checklist */
.checklist { list-style: none; padding: 0; margin: 1rem 0; }
.cl-item {
  display: flex; align-items: flex-start; gap: 0.75rem;
  padding: 0.6rem 0;
  font-size: 0.9rem; color: var(--text-soft); line-height: 1.5;
}
.cl-item .cl-num {
  width: 1.75rem; height: 1.75rem; flex-shrink: 0;
  background: rgba(168, 85, 247, 0.12); color: #c084fc;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.75rem; font-weight: 600;
}
.cl-item code {
  background: rgba(255,255,255,0.06); padding: 0.15rem 0.5rem;
  border-radius: 4px; font-size: 0.82rem;
}
.cl-item strong { color: var(--text); }

/* Button row */
.btn-row { display: flex; justify-content: space-between; align-items: center; margin-top: 2rem; }
.btn-next {
  padding: 0.75rem 1.75rem;
  background: linear-gradient(135deg, var(--accent-solid), var(--accent-indigo));
  color: #fff; font-family: var(--font); font-size: 0.9rem; font-weight: 500;
  border: none; border-radius: var(--radius-sm);
  cursor: pointer; transition: all var(--transition);
}
.btn-next:hover { transform: translateY(-1px); box-shadow: 0 0 20px rgba(168,85,247,0.25); }
.btn-next:disabled { opacity: 0.35; cursor: not-allowed; transform: none; box-shadow: none; }

/* Success page */
.success-check {
  width: 72px; height: 72px;
  margin: 0 auto 1.5rem;
  background: rgba(16,185,129,0.1);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  animation: scaleIn 0.5s cubic-bezier(.34,1.56,.64,1);
}
@keyframes scaleIn { from { transform: scale(0); } to { transform: scale(1); } }
.success-check svg { width: 36px; height: 36px; color: var(--accent-green); }

/* Support card */
.support-card {
  background: rgba(234, 179, 8, 0.05);
  border: 1px solid rgba(234, 179, 8, 0.15);
  border-radius: var(--radius);
  padding: 1.5rem;
  text-align: center;
  margin: 2rem 0;
}
.support-card p { font-size: 0.9rem; color: var(--text-soft); margin-bottom: 0.75rem; }
.donate-btn {
  display: inline-flex; align-items: center; gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  background: rgba(234, 179, 8, 0.1); border: 1px solid rgba(234, 179, 8, 0.2);
  border-radius: var(--radius-sm);
  color: #fbbf24; font-family: var(--font); font-size: 0.9rem; font-weight: 500;
  text-decoration: none; transition: all var(--transition);
}
.donate-btn:hover { background: rgba(234, 179, 8, 0.15); }

/* Share card */
.share-card {
  text-align: center; margin: 1.5rem 0;
}
.share-card p { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 0.75rem; }
.share-row { display: flex; gap: 0.75rem; justify-content: center; }
.share-btn {
  padding: 0.6rem 1.25rem;
  background: var(--glass); border: 1px solid var(--card-border);
  border-radius: var(--radius-sm);
  color: var(--text-soft); font-family: var(--font); font-size: 0.85rem;
  cursor: pointer; transition: all var(--transition); text-decoration: none;
}
.share-btn:hover { background: var(--card-hover); color: var(--text); }

/* Comparison table */
.compare-table {
  width: 100%; border-collapse: collapse;
  margin: 2rem 0; font-size: 0.85rem;
}
.compare-table th {
  text-align: left; padding: 0.6rem 0.75rem;
  border-bottom: 1px solid var(--card-border);
  color: var(--text-muted); font-weight: 500; font-size: 0.75rem;
  text-transform: uppercase; letter-spacing: 0.05em;
}
.compare-table td {
  padding: 0.6rem 0.75rem;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  color: var(--text-soft);
}
.compare-table td:first-child { color: var(--text); font-weight: 500; }

/* Footer */
.footer-links {
  display: flex; gap: 1.5rem; justify-content: center;
  margin-top: 2rem; padding-top: 1.5rem;
  border-top: 1px solid var(--card-border);
}
.footer-links a { color: var(--text-muted); font-size: 0.8rem; text-decoration: none; }
.footer-links a:hover { color: var(--text-soft); }

/* Notice box */
.notice {
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-sm);
  padding: 1rem 1.25rem;
  font-size: 0.85rem; line-height: 1.6;
  color: var(--text-soft);
  margin-bottom: 1.5rem;
}
.notice.warning {
  background: rgba(234, 179, 8, 0.05);
  border-color: rgba(234, 179, 8, 0.15);
}

/* Separator */
.sep { height: 1px; background: var(--card-border); margin: 2rem 0; }

/* Lightbox */
.lightbox {
  display: none; position: fixed; inset: 0; z-index: 300;
  background: rgba(0,0,0,0.85); backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  justify-content: center; align-items: center;
  cursor: pointer;
}
.lightbox.open { display: flex; }
.lightbox img {
  max-width: 90%; max-height: 85vh;
  border-radius: var(--radius);
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}

/* Guide images */
.guide-img {
  width: 100%; border-radius: var(--radius-sm);
  border: 1px solid var(--card-border);
  cursor: pointer; transition: opacity var(--transition);
  margin: 0.75rem 0;
}
.guide-img:hover { opacity: 0.85; }
  </style>
</head>
<body>
  <div class="ambient">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>

  <!-- Nav -->
  <nav class="nav">
    <div style="display:flex;align-items:center;gap:0.75rem">
      <a class="nav-logo" href="#">FreeClaw</a>
      <a class="nav-badge" href="https://x.com/Andrey__HQ" target="_blank" rel="noopener">by @Andrey__HQ</a>
    </div>
    <div class="nav-links">
      <a href="https://docs.openclaw.ai/" target="_blank" rel="noopener">Docs</a>
      <a href="https://github.com/andreycpu/freeclaw" target="_blank" rel="noopener">GitHub</a>
    </div>
  </nav>

  <div class="container">

    <!-- LANDING -->
    <div class="landing" id="landing">
      <div class="landing-badge">100% free, runs locally</div>
      <h1>Set up <span class="gradient-text">OpenClaw</span> in 10 minutes</h1>
      <p class="landing-sub">Your own AI assistant on Telegram, Discord, WhatsApp, or Slack. No coding. Seriously free.</p>

      <div class="warning-card">
        <div class="warning-card-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
          Read before continuing
        </div>
        <p>This software runs code on your computer and has access to your messaging accounts. While security vulnerabilities have been minimized, no software is 100% secure. FreeClaw is not affiliated with <a href="https://openclaw.ai/" target="_blank" rel="noopener">OpenClaw</a> - this is a community tool.</p>
      </div>

      <label class="disclaimer-check">
        <input type="checkbox" id="acceptRisk" onchange="updateCTA()">
        <span>I understand the risks and want to continue</span>
      </label>

      <button class="cta" id="startBtn" disabled onclick="startWizard()">Get Started</button>

      <div class="info-card">
        <p>FreeClaw generates a setup script that installs <a href="https://openclaw.ai/" target="_blank" rel="noopener">OpenClaw</a> on your computer. Your API keys stay on your machine - nothing is sent to our servers. <a href="https://docs.openclaw.ai/" target="_blank" rel="noopener">Read the docs</a></p>
      </div>
    </div>

    <!-- WIZARD -->
    <div class="wizard" id="wizard">
      <!-- Progress bar -->
      <div class="progress-wrap" id="progressWrap">
        <div class="progress-bar">
          <div class="progress-fill" id="pFill"></div>
        </div>
        <div class="progress-labels" id="pLabels">
          <span>Platform</span>
          <span>AI Model</span>
          <span>Setup</span>
          <span>Personality</span>
          <span>Download</span>
          <span>Run</span>
          <span>Done</span>
        </div>
      </div>

      <!-- STEP 1: Platform -->
      <div class="step" data-step="1">
        <button class="back-arrow" onclick="goBack(0)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          Back
        </button>
        <h2 class="step-head">Where do you want to chat?</h2>
        <p class="step-sub">Pick the messaging app your bot will live in.</p>
        <div class="card-grid" id="platformCards">
          <div class="card" data-value="telegram" onclick="selectCard('chatPlatform','telegram',this)">
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0h-.056zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.96 6.504-1.36 8.63-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.479.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
            <div class="card-title">Telegram</div>
            <div class="card-desc">Easiest - 2 minutes</div>
          </div>
          <div class="card" data-value="discord" onclick="selectCard('chatPlatform','discord',this)">
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.947 2.418-2.157 2.418z"/></svg>
            <div class="card-title">Discord</div>
            <div class="card-desc">Easy - 3 minutes</div>
          </div>
          <div class="card" data-value="whatsapp" onclick="selectCard('chatPlatform','whatsapp',this)">
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 0 0-3.48-8.413z"/></svg>
            <div class="card-title">WhatsApp</div>
            <div class="card-desc">Moderate - QR code scan</div>
          </div>
          <div class="card" data-value="slack" onclick="selectCard('chatPlatform','slack',this)">
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z"/></svg>
            <div class="card-title">Slack</div>
            <div class="card-desc">Moderate - 5 minutes</div>
          </div>
        </div>
        <div class="btn-row" style="justify-content:flex-end">
          <button class="btn-next" id="step1Next" disabled onclick="goToStep(2)">Next</button>
        </div>
      </div>

      <!-- STEP 2: AI Model -->
      <div class="step" data-step="2">
        <button class="back-arrow" onclick="goToStep(1)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          Back
        </button>
        <h2 class="step-head">Choose your AI brain</h2>
        <p class="step-sub">Pick which AI will power your chatbot.</p>
        <div class="card-grid three" id="modelCards">
          <div class="card" data-value="anthropic" onclick="selectCard('aiProvider','anthropic',this)">
            <span class="rec-tag">Recommended</span>
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M13.827 3.52h3.603L24 20.48h-3.603l-6.57-16.96zm-7.258 0h3.767L16.906 20.48h-3.674l-1.479-3.906H5.807l-1.472 3.906H.762L6.57 3.52zm.901 3.63L5.047 13.642h5.765L8.39 7.15h-.92z"/></svg>
            <div class="card-title">Claude</div>
            <div class="card-desc">by Anthropic</div>
          </div>
          <div class="card" data-value="openai" onclick="selectCard('aiProvider','openai',this)">
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M22.282 9.821a5.985 5.985 0 0 0-.516-4.91 6.046 6.046 0 0 0-6.51-2.9A6.065 6.065 0 0 0 4.981 4.18a5.998 5.998 0 0 0-3.998 2.9 6.046 6.046 0 0 0 .743 7.097 5.98 5.98 0 0 0 .51 4.911 6.051 6.051 0 0 0 6.515 2.9A5.985 5.985 0 0 0 13.26 24a6.056 6.056 0 0 0 5.772-4.206 5.99 5.99 0 0 0 3.997-2.9 6.056 6.056 0 0 0-.747-7.073zM13.26 22.43a4.476 4.476 0 0 1-2.876-1.04l.141-.081 4.779-2.758a.795.795 0 0 0 .392-.681v-6.737l2.02 1.168a.071.071 0 0 1 .038.052v5.583a4.504 4.504 0 0 1-4.494 4.494zM3.6 18.304a4.47 4.47 0 0 1-.535-3.014l.142.085 4.783 2.759a.771.771 0 0 0 .78 0l5.843-3.369v2.332a.08.08 0 0 1-.033.062L9.74 19.95a4.5 4.5 0 0 1-6.14-1.646zM2.34 7.896a4.485 4.485 0 0 1 2.366-1.973V11.6a.766.766 0 0 0 .388.676l5.815 3.355-2.02 1.168a.076.076 0 0 1-.071 0l-4.83-2.786A4.504 4.504 0 0 1 2.34 7.872zm16.597 3.855l-5.833-3.387L15.119 7.2a.076.076 0 0 1 .071 0l4.83 2.791a4.494 4.494 0 0 1-.676 8.105v-5.678a.79.79 0 0 0-.407-.667zm2.01-3.023l-.141-.085-4.774-2.782a.776.776 0 0 0-.785 0L9.409 9.23V6.897a.066.066 0 0 1 .028-.061l4.83-2.787a4.5 4.5 0 0 1 6.68 4.66zm-12.64 4.135l-2.02-1.164a.08.08 0 0 1-.038-.057V6.075a4.5 4.5 0 0 1 7.375-3.453l-.142.08L8.704 5.46a.795.795 0 0 0-.393.681zm1.097-2.365l2.602-1.5 2.602 1.5v3.001l-2.602 1.5-2.602-1.5z"/></svg>
            <div class="card-title">ChatGPT</div>
            <div class="card-desc">by OpenAI</div>
          </div>
          <div class="card" data-value="google" onclick="selectCard('aiProvider','google',this)">
            <div class="card-check"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg></div>
            <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12 11.366v3.6h5.2c-.436 2.07-2.372 3.624-5.2 3.624a5.997 5.997 0 0 1-5.994-5.994A5.997 5.997 0 0 1 12 6.602c1.44 0 2.796.508 3.852 1.44l2.604-2.604A9.957 9.957 0 0 0 12 2.994 9.01 9.01 0 0 0 2.994 12 9.01 9.01 0 0 0 12 21.006c7.422 0 9.006-6.936 8.076-9.636z"/></svg>
            <div class="card-title">Gemini</div>
            <div class="card-desc">by Google</div>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">API Key</label>
          <div class="input-wrap">
            <input type="password" id="apiKey" placeholder="Paste your API key" oninput="onApiKeyInput(this)">
            <button class="api-toggle" onclick="toggleVis('apiKey')" title="Show/hide">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
          <div class="form-hint">Your key never leaves your browser.</div>
          <div class="form-error" id="apiKeyError">Key format doesn't look right. Check and try again.</div>
          <div class="form-success" id="apiKeySuccess">Format looks good.</div>
          <button class="guide-link" id="apiGuideLink" onclick="openApiModal()" style="display:none">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01"/></svg>
            How to get your API key
          </button>
        </div>

        <div class="btn-row">
          <div></div>
          <button class="btn-next" id="step2Next" disabled onclick="goToStep(3)">Next</button>
        </div>
      </div>

      <!-- STEP 3: Platform Setup -->
      <div class="step" data-step="3">
        <button class="back-arrow" onclick="goToStep(2)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          Back
        </button>
        <h2 class="step-head" id="step3Title">Set up your bot</h2>
        <p class="step-sub" id="step3Sub">Follow these steps to create your bot token.</p>

        <div id="platformGuide"></div>

        <div class="btn-row">
          <div></div>
          <button class="btn-next" id="step3Next" disabled onclick="goToStep(4)">Next</button>
        </div>
      </div>

      <!-- STEP 4: Personality -->
      <div class="step" data-step="4">
        <button class="back-arrow" onclick="goToStep(3)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          Back
        </button>
        <h2 class="step-head">Make it yours</h2>
        <p class="step-sub">Give your bot a name and personality.</p>

        <div class="form-row">
          <label class="form-label">What should your bot call you?</label>
          <input type="text" class="form-input" id="uName" placeholder="Your name" maxlength="50" oninput="validateStep4()">
        </div>

        <div class="form-row">
          <label class="form-label">Pick a style (select one or more)</label>
          <div class="chips" id="styleChips">
            <button class="chip" data-value="chill" onclick="toggleChip('chill',this)">Chill</button>
            <button class="chip" data-value="professional" onclick="toggleChip('professional',this)">Professional</button>
            <button class="chip" data-value="friendly" onclick="toggleChip('friendly',this)">Friendly</button>
            <button class="chip" data-value="witty" onclick="toggleChip('witty',this)">Witty</button>
            <button class="chip" data-value="minimal" onclick="toggleChip('minimal',this)">Minimal</button>
          </div>
        </div>

        <div class="form-row">
          <label class="form-label">Custom instructions (optional)</label>
          <textarea class="form-input" id="inst" placeholder="You are a knowledgeable personal assistant who helps with daily tasks, answers questions in depth, and adapts to the conversation. When asked about a topic, provide clear explanations with relevant examples. Break down complex subjects into simple terms. If you don't know something, say so honestly rather than guessing. Keep responses organized with bullet points or numbered steps when listing things. Match the user's energy - be concise when they ask quick questions, and go deeper when they want to explore a topic. Remember context from earlier in the conversation and reference it naturally. Proactively suggest related ideas or follow-up actions when relevant." maxlength="2000" oninput="updateCharCount()"></textarea>
          <div class="form-hint"><span id="charCount">2000</span> characters remaining</div>
        </div>

        <div class="btn-row">
          <div></div>
          <button class="btn-next" id="step4Next" disabled onclick="goToStep(5)">Next</button>
        </div>
      </div>

      <!-- STEP 5: Download -->
      <div class="step" data-step="5">
        <button class="back-arrow" onclick="goToStep(4)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          Back
        </button>
        <h2 class="step-head">Your setup file is ready</h2>
        <p class="step-sub" id="dlSub">Download it and run it on your computer.</p>

        <div class="dl-box" id="dlBox"></div>

        <div class="notice warning">
          This file contains your API keys. Keep it private and don't share it.
        </div>

        <div class="btn-row">
          <div></div>
          <button class="btn-next" onclick="goToStep(6)">Next: Run Instructions</button>
        </div>
      </div>

      <!-- STEP 6: Run Instructions -->
      <div class="step" data-step="6">
        <button class="back-arrow" onclick="goToStep(5)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
          Back
        </button>
        <h2 class="step-head">Run it</h2>
        <p class="step-sub">Follow these steps to start your bot.</p>

        <div id="runInstructions"></div>

        <div class="btn-row">
          <div></div>
          <button class="btn-next" onclick="goToStep(7)">Done</button>
        </div>
      </div>

      <!-- STEP 7: Success -->
      <div class="step" data-step="7">
        <div style="text-align:center">
          <div class="success-check">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
          </div>
          <h2 class="step-head">Your bot is live!</h2>
          <p class="step-sub" id="successMsg" style="margin-bottom:1rem">Go chat with it.</p>
          <a class="cta" id="openChatBtn" href="#" target="_blank" rel="noopener" style="text-decoration:none">Open Chat</a>
        </div>

        <div class="support-card">
          <p>If this was helpful for you, feel free to support me.</p>
          <a class="donate-btn" href="https://polar.sh/checkout/polar_c_oMMCBHA4GtlTMPvuWxYmpjcwBVwBjhz4V3RMw07nAzQ" target="_blank" rel="noopener">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
            Support FreeClaw
          </a>
        </div>

        <div class="share-card">
          <p>Tell your friends</p>
          <div class="share-row">
            <button class="share-btn" onclick="copyShareText(this)">Copy share link</button>
            <a class="share-btn" id="tweetLink" href="#" target="_blank" rel="noopener">Share on X</a>
          </div>
        </div>

        <table class="compare-table">
          <thead>
            <tr><th>Feature</th><th>FreeClaw</th><th>Others</th></tr>
          </thead>
          <tbody>
            <tr><td>Cost</td><td>Free + API costs</td><td>$10-50/mo</td></tr>
            <tr><td>Your data</td><td>Stays on your computer</td><td>On their servers</td></tr>
            <tr><td>Coding required</td><td>None</td><td>Usually</td></tr>
            <tr><td>Setup time</td><td>~10 minutes</td><td>30-60 minutes</td></tr>
          </tbody>
        </table>

        <div class="footer-links">
          <a href="https://docs.openclaw.ai/" target="_blank" rel="noopener">OpenClaw Docs</a>
          <a href="https://github.com/andreycpu/freeclaw" target="_blank" rel="noopener">GitHub</a>
          <a href="https://discord.gg/clawd" target="_blank" rel="noopener">Discord</a>
        </div>
      </div>
    </div>
  </div>

  <!-- API Key Guide Modal -->
  <div class="api-modal-overlay" id="apiModal" onclick="if(event.target===this)closeApiModal()">
    <div class="api-modal">
      <button class="api-modal-close" onclick="closeApiModal()">&times;</button>
      <h3 id="apiModalTitle">Get your API key</h3>
      <div id="apiModalBody"></div>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" onclick="closeLightbox()">
    <img id="lightbox-img" src="" alt="Guide screenshot">
  </div>

  <script>
/* ===========================================================================
   FreeClaw - Client-side wizard & script generator
   All logic runs in the browser. No data is sent anywhere.
   =========================================================================== */

// ---------------------------------------------------------------------------
// State
// ---------------------------------------------------------------------------
const state = {
  os: null,
  chatPlatform: null,
  aiProvider: null,
  apiKey: '',
  userName: '',
  personalities: [],
  customInstructions: '',
  telegram: { botToken: '', botUsername: '' },
  discord: { token: '', serverId: '' },
  whatsapp: {},
  slack: { botToken: '', appToken: '' }
};

const TOTAL_STEPS = 7;

const providerMap = {
  anthropic: { model: 'anthropic/claude-sonnet-4-20250514', envVar: 'ANTHROPIC_API_KEY', authChoice: 'apiKey', authFlag: '--anthropic-api-key', prefix: 'sk-ant-', name: 'Anthropic', keyUrl: 'https://console.anthropic.com/settings/keys' },
  openai: { model: 'openai/gpt-4o', envVar: 'OPENAI_API_KEY', authChoice: 'openai-api-key', authFlag: '--openai-api-key', prefix: 'sk-', name: 'OpenAI', keyUrl: 'https://platform.openai.com/api-keys' },
  google: { model: 'google/gemini-2.0-flash', envVar: 'GEMINI_API_KEY', authChoice: 'gemini-api-key', authFlag: '--gemini-api-key', prefix: '', name: 'Google', keyUrl: 'https://aistudio.google.com/apikey' }
};

const personalities = {
  chill: "You are a chill, laid-back AI assistant. You keep things casual and relaxed. You use informal language but you're still helpful and knowledgeable. You might use slang occasionally. You don't overthink things - you give straightforward answers without being stiff about it.",
  professional: "You are a professional AI assistant. You communicate clearly and formally. You provide thorough, well-structured responses. You maintain a courteous and business-appropriate tone at all times.",
  friendly: "You are a warm, friendly AI assistant. You're enthusiastic and encouraging. You make people feel comfortable asking questions. You celebrate their wins and support them through challenges. You're like a knowledgeable friend who's always happy to help.",
  witty: "You are a witty, clever AI assistant. You enjoy wordplay and humor. You're sharp and quick with responses, often adding a touch of humor while still being genuinely helpful. You never sacrifice helpfulness for a joke, but you make the conversation enjoyable.",
  minimal: "You are a concise AI assistant. You give short, direct answers. No fluff, no filler. You respect the user's time and get straight to the point. You expand only when asked."
};

// ---------------------------------------------------------------------------
// OS Detection
// ---------------------------------------------------------------------------
(function detectOS() {
  const ua = navigator.userAgent || navigator.platform || '';
  if (/Win/i.test(ua)) state.os = 'windows';
  else if (/Mac/i.test(ua)) state.os = 'macos';
})();

// ---------------------------------------------------------------------------
// Landing
// ---------------------------------------------------------------------------
function updateCTA() {
  document.getElementById('startBtn').disabled = !document.getElementById('acceptRisk').checked;
}

function startWizard() {
  document.getElementById('landing').style.display = 'none';
  document.getElementById('wizard').classList.add('active');
  goToStep(1);
}

// ---------------------------------------------------------------------------
// Navigation
// ---------------------------------------------------------------------------
function goToStep(n) {
  document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
  const target = document.querySelector(`.step[data-step="${n}"]`);
  if (target) target.classList.add('active');
  updateProgress(n);
  window.scrollTo({ top: 0, behavior: 'smooth' });

  if (n === 3) renderStep3();
  if (n === 5) renderStep5();
  if (n === 6) renderStep6();
  if (n === 7) renderStep7();
}

function goBack(n) {
  if (n === 0) {
    document.getElementById('wizard').classList.remove('active');
    document.getElementById('landing').style.display = '';
    return;
  }
  goToStep(n);
}

function updateProgress(step) {
  const pct = ((step - 1) / (TOTAL_STEPS - 1)) * 100;
  document.getElementById('pFill').style.width = pct + '%';
  const labels = document.querySelectorAll('#pLabels span');
  labels.forEach((l, i) => {
    l.classList.remove('active', 'done');
    if (i + 1 < step) l.classList.add('done');
    else if (i + 1 === step) l.classList.add('active');
  });
}

// ---------------------------------------------------------------------------
// Card Selection
// ---------------------------------------------------------------------------
function selectCard(field, value, el) {
  const parent = el.parentElement;
  parent.querySelectorAll('.card').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  state[field] = value;

  if (field === 'chatPlatform') {
    document.getElementById('step1Next').disabled = false;
  }
  if (field === 'aiProvider') {
    const p = providerMap[value];
    const input = document.getElementById('apiKey');
    if (input) input.placeholder = p.prefix ? p.prefix + '...' : 'Paste your API key';
    document.getElementById('apiGuideLink').style.display = '';
    validateStep2();
  }
}

// ---------------------------------------------------------------------------
// Chip Selection (personality - multi-select)
// ---------------------------------------------------------------------------
function toggleChip(value, el) {
  el.classList.toggle('selected');
  const idx = state.personalities.indexOf(value);
  if (idx > -1) state.personalities.splice(idx, 1);
  else state.personalities.push(value);
  validateStep4();
}

// ---------------------------------------------------------------------------
// API Key
// ---------------------------------------------------------------------------
function onApiKeyInput(el) {
  state.apiKey = el.value.trim();
  const p = providerMap[state.aiProvider];
  const err = document.getElementById('apiKeyError');
  const ok = document.getElementById('apiKeySuccess');
  err.style.display = 'none';
  ok.style.display = 'none';
  if (p && state.apiKey.length > 8) {
    if (p.prefix && !state.apiKey.startsWith(p.prefix)) {
      err.style.display = 'block';
    } else {
      ok.style.display = 'block';
    }
  }
  validateStep2();
}

function validateStep2() {
  const valid = state.aiProvider && state.apiKey.length > 8;
  document.getElementById('step2Next').disabled = !valid;
}

function toggleVis(id) {
  const input = document.getElementById(id);
  input.type = input.type === 'password' ? 'text' : 'password';
}

// ---------------------------------------------------------------------------
// API Guide Modal
// ---------------------------------------------------------------------------
function openApiModal() {
  const p = providerMap[state.aiProvider];
  if (!p) return;
  const guides = {
    anthropic: '<ol class="guide-steps"><li>Go to <a href="https://console.anthropic.com/settings/keys" target="_blank" rel="noopener">console.anthropic.com</a></li><li>Sign up or log in</li><li>Click "API Keys" in the left sidebar</li><li>Click "Create Key"</li><li>Copy the key (starts with <code>sk-ant-</code>)</li></ol>',
    openai: '<ol class="guide-steps"><li>Go to <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener">platform.openai.com</a></li><li>Sign up or log in</li><li>Click your profile icon, then "API Keys"</li><li>Click "Create new secret key"</li><li>Copy the key (starts with <code>sk-</code>)</li></ol>',
    google: '<ol class="guide-steps"><li>Go to <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">aistudio.google.com</a></li><li>Sign in with your Google account</li><li>Click "Get API Key"</li><li>Click "Create API key"</li><li>Copy the key</li></ol>'
  };
  document.getElementById('apiModalTitle').textContent = 'Get your ' + p.name + ' API key';
  document.getElementById('apiModalBody').innerHTML = guides[state.aiProvider] || '';
  document.getElementById('apiModal').classList.add('open');
}

function closeApiModal() {
  document.getElementById('apiModal').classList.remove('open');
}

// ---------------------------------------------------------------------------
// Step 3: Platform setup guide
// ---------------------------------------------------------------------------
function renderStep3() {
  const el = document.getElementById('platformGuide');
  const title = document.getElementById('step3Title');
  const sub = document.getElementById('step3Sub');

  const guides = {
    telegram: () => {
      title.textContent = 'Set up your Telegram bot';
      sub.textContent = 'Create a bot with BotFather and paste your token.';
      return `
        <div class="setup-box">
          <h3>Create your bot</h3>
          <ol class="guide-steps">
            <li>Open Telegram and search for <strong>@BotFather</strong></li>
            <li>Send the message: <code>/newbot</code></li>
            <li>BotFather will ask for a name - type anything (e.g., "My AI Assistant")</li>
            <li>Choose a username ending in "bot" (e.g., "myai_helper_bot")</li>
            <li>BotFather will give you a token - copy it below</li>
          </ol>
        </div>
        <div class="form-row">
          <label class="form-label">Bot Username</label>
          <input type="text" class="form-input" id="bUsername" placeholder="myai_helper_bot" oninput="state.telegram.botUsername=this.value.trim().replace(/^@/,'');validateStep3()">
          <div class="form-hint">The username you chose, without the @ sign</div>
        </div>
        <div class="form-row">
          <label class="form-label">Bot Token</label>
          <div class="input-wrap">
            <input type="password" id="bToken" placeholder="123456:ABC-DEF..." oninput="state.telegram.botToken=this.value.trim();validateStep3()">
            <button class="api-toggle" onclick="toggleVis('bToken')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
          </div>
        </div>
        ${platformFAQ('telegram')}`;
    },
    discord: () => {
      title.textContent = 'Set up your Discord bot';
      sub.textContent = 'Create a bot in the Discord Developer Portal.';
      return `
        <div class="setup-box">
          <h3>Create your bot</h3>
          <ol class="guide-steps">
            <li>Go to <a href="https://discord.com/developers/applications" target="_blank" rel="noopener">discord.com/developers/applications</a></li>
            <li>Click "New Application" and name it</li>
            <li>Go to the "Bot" tab on the left</li>
            <li>Click "Reset Token" and copy the token</li>
            <li>Scroll down and enable <strong>Message Content Intent</strong></li>
            <li>Go to "OAuth2" > "URL Generator"</li>
            <li>Check "bot" under Scopes, then check "Send Messages" and "Read Message History"</li>
            <li>Copy the generated URL and open it to add your bot to a server</li>
          </ol>
        </div>
        <div class="form-row">
          <label class="form-label">Bot Token</label>
          <div class="input-wrap">
            <input type="password" id="discordToken" placeholder="Bot token" oninput="state.discord.token=this.value.trim();validateStep3()">
            <button class="api-toggle" onclick="toggleVis('discordToken')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
          </div>
        </div>
        <div class="form-row">
          <label class="form-label">Server ID</label>
          <input type="text" class="form-input" id="discordServer" placeholder="123456789012345678" oninput="state.discord.serverId=this.value.trim();validateStep3()">
          <div class="form-hint">Right-click your server name > "Copy Server ID" (enable Developer Mode in Settings > Advanced)</div>
        </div>
        ${platformFAQ('discord')}`;
    },
    whatsapp: () => {
      title.textContent = 'WhatsApp setup';
      sub.textContent = 'WhatsApp uses QR code pairing - no token needed!';
      return `
        <div class="setup-box">
          <h3>How it works</h3>
          <p style="font-size:0.88rem;color:var(--text-soft);margin-bottom:1rem">After running the setup script, a QR code will appear in your terminal. Scan it with WhatsApp on your phone.</p>
          <ol class="guide-steps">
            <li>Run the setup script (next step)</li>
            <li>A QR code will appear in the terminal window</li>
            <li>Open WhatsApp on your phone</li>
            <li>Go to <strong>Settings > Linked Devices > Link a Device</strong></li>
            <li>Scan the QR code shown in your terminal</li>
          </ol>
        </div>
        ${platformFAQ('whatsapp')}`;
    },
    slack: () => {
      title.textContent = 'Set up your Slack bot';
      sub.textContent = 'Create a Slack app with the right permissions.';
      return `
        <div class="setup-box">
          <h3>Create your Slack app</h3>
          <ol class="guide-steps">
            <li>Go to <a href="https://api.slack.com/apps" target="_blank" rel="noopener">api.slack.com/apps</a></li>
            <li>Click "Create New App" > "From scratch"</li>
            <li>Name your app and select your workspace</li>
            <li>Go to "OAuth & Permissions" and add Bot Token Scopes: <code>chat:write</code>, <code>app_mentions:read</code>, <code>im:history</code>, <code>im:read</code>, <code>im:write</code></li>
            <li>Click "Install to Workspace" and authorize</li>
            <li>Copy the <strong>Bot User OAuth Token</strong> (starts with <code>xoxb-</code>)</li>
            <li>Go to "Socket Mode" and enable it</li>
            <li>Generate an App-Level Token with <code>connections:write</code> scope (starts with <code>xapp-</code>)</li>
            <li>Go to "Event Subscriptions", enable events, add: <code>message.im</code>, <code>app_mention</code></li>
          </ol>
        </div>
        <div class="form-row">
          <label class="form-label">Bot Token</label>
          <div class="input-wrap">
            <input type="password" id="slackBot" placeholder="xoxb-..." oninput="state.slack.botToken=this.value.trim();validateStep3()">
            <button class="api-toggle" onclick="toggleVis('slackBot')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
          </div>
        </div>
        <div class="form-row">
          <label class="form-label">App Token</label>
          <div class="input-wrap">
            <input type="password" id="slackApp" placeholder="xapp-..." oninput="state.slack.appToken=this.value.trim();validateStep3()">
            <button class="api-toggle" onclick="toggleVis('slackApp')"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
          </div>
        </div>
        ${platformFAQ('slack')}`;
    }
  };

  const renderer = guides[state.chatPlatform];
  el.innerHTML = renderer ? renderer() : '';
  validateStep3();
}

function platformFAQ(platform) {
  const faqs = {
    telegram: [
      { q: 'Where do I find BotFather?', a: 'Search for @BotFather in Telegram - it\'s an official Telegram bot. It has a blue verification checkmark.' },
      { q: 'Can I change the bot name later?', a: 'Yes, send /setname to BotFather to change the display name, or /setdescription to change the description.' }
    ],
    discord: [
      { q: 'How do I enable Developer Mode?', a: 'Open Discord Settings > Advanced > toggle on Developer Mode. Then you can right-click server names to copy IDs.' },
      { q: 'What permissions does the bot need?', a: 'At minimum: Send Messages and Read Message History. The bot only responds in channels where it has access.' }
    ],
    whatsapp: [
      { q: 'Will this affect my WhatsApp account?', a: 'The bot links as a new device to your WhatsApp, similar to WhatsApp Web. You can unlink it anytime from Settings > Linked Devices.' },
      { q: 'Do I need a separate phone number?', a: 'No, it uses your existing WhatsApp account through the linked devices feature.' }
    ],
    slack: [
      { q: 'Which Slack plan do I need?', a: 'The free Slack plan works. Socket Mode is available on all plans.' },
      { q: 'Can the bot access all channels?', a: 'The bot only responds in channels where it\'s been invited or in direct messages.' }
    ]
  };
  const items = faqs[platform] || [];
  if (!items.length) return '';
  return `<div class="faq-section">${items.map(f =>
    `<div class="faq-item"><div class="faq-q" onclick="toggleFAQ(this)">${f.q}<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div><div class="faq-a">${f.a}</div></div>`
  ).join('')}</div>`;
}

function toggleFAQ(el) {
  el.classList.toggle('open');
  el.nextElementSibling.classList.toggle('open');
}

function validateStep3() {
  let valid = true;
  switch (state.chatPlatform) {
    case 'telegram': valid = state.telegram.botToken.length > 10 && state.telegram.botUsername.length > 2; break;
    case 'discord': valid = state.discord.token.length > 10 && state.discord.serverId.length > 10; break;
    case 'whatsapp': valid = true; break;
    case 'slack': valid = state.slack.botToken.length > 10 && state.slack.appToken.length > 10; break;
  }
  const btn = document.getElementById('step3Next');
  if (btn) btn.disabled = !valid;
}

function validateStep4() {
  const name = document.getElementById('uName').value.trim();
  state.userName = name;
  state.customInstructions = (document.getElementById('inst').value || '').trim();
  const btn = document.getElementById('step4Next');
  if (btn) btn.disabled = !(name.length > 0 && state.personalities.length > 0);
}

function updateCharCount() {
  const textarea = document.getElementById('inst');
  const remaining = 2000 - textarea.value.length;
  document.getElementById('charCount').textContent = remaining;
  validateStep4();
}

// ---------------------------------------------------------------------------
// Step 5: Download
// ---------------------------------------------------------------------------
function renderStep5() {
  const box = document.getElementById('dlBox');
  if (state.os === 'macos') {
    box.innerHTML = `
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--accent-solid)" stroke-width="1.5"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8M12 17v4"/></svg>
      <p class="dl-label" style="margin-top:1rem">Copy a single terminal command that sets everything up</p>
      <button class="copy-btn" onclick="copyTerminalCmd(this)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
        <span id="copyBtnText">Copy command</span>
      </button>
      <p class="dl-note">Or <a href="#" onclick="downloadScript();return false" style="color:var(--accent-solid)">download as .command file</a></p>`;
  } else {
    box.innerHTML = `
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--accent-solid)" stroke-width="1.5"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
      <p class="dl-label" style="margin-top:1rem">Download your setup file</p>
      <button class="dl-btn" onclick="downloadScript()">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
        Download freeclaw-setup.bat
      </button>
      <p class="dl-note">~5 KB - contains your configuration</p>`;
  }
}

function escapeHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function copyTerminalCmd(btn) {
  const cmd = generateMacTerminalCommand();
  navigator.clipboard.writeText(cmd).then(() => {
    const txt = document.getElementById('copyBtnText');
    txt.textContent = 'Copied!';
    setTimeout(() => txt.textContent = 'Copy to clipboard', 2000);
  });
}

function generateMacTerminalCommand() {
  const script = generateMacScript();
  const b64 = btoa(unescape(encodeURIComponent(script)));
  return `echo '${b64}' | base64 -d | bash`;
}

// ---------------------------------------------------------------------------
// Step 6: Run Instructions
// ---------------------------------------------------------------------------
function renderStep6() {
  const el = document.getElementById('runInstructions');
  if (state.os === 'windows') {
    el.innerHTML = `
      <ul class="checklist">
        <li class="cl-item"><span class="cl-num">1</span><span>Find the downloaded file - usually in your <strong>Downloads</strong> folder</span></li>
        <li class="cl-item"><span class="cl-num">2</span><span>Double-click <code>freeclaw-setup.bat</code></span></li>
        <li class="cl-item"><span class="cl-num">3</span><span>Windows might show a warning - click <strong>"More info"</strong>, then <strong>"Run anyway"</strong></span></li>
        <li class="cl-item"><span class="cl-num">4</span><span>Wait 2-3 minutes for setup to complete</span></li>
        <li class="cl-item"><span class="cl-num">5</span><span>Your bot will start and your chat app will open</span></li>
      </ul>
      <div class="setup-box" style="margin-top:1.5rem">
        <h3>Troubleshooting</h3>
        <div class="faq-item"><div class="faq-q" onclick="toggleFAQ(this)">Script won't run<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div><div class="faq-a">Right-click the file and select "Run as administrator". Make sure the file extension is <code>.bat</code>, not <code>.bat.txt</code>.</div></div>
        <div class="faq-item"><div class="faq-q" onclick="toggleFAQ(this)">Blocked by antivirus<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div><div class="faq-a">Some antivirus programs block downloaded scripts. Temporarily pause your antivirus, run the script, then re-enable it. The script only downloads from official sources (nodejs.org, github.com).</div></div>
        <div class="faq-item"><div class="faq-q" onclick="toggleFAQ(this)">Setup fails with an error<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div><div class="faq-a">Check that you have an internet connection and at least 500MB of free disk space. Try running the script again.</div></div>
      </div>`;
  } else {
    el.innerHTML = `
      <ul class="checklist">
        <li class="cl-item"><span class="cl-num">1</span><span>Open <strong>Terminal</strong> (search for it in Spotlight with Cmd+Space)</span></li>
        <li class="cl-item"><span class="cl-num">2</span><span>Paste the command you copied and press <strong>Enter</strong></span></li>
        <li class="cl-item"><span class="cl-num">3</span><span>Enter your Mac login password if asked</span></li>
        <li class="cl-item"><span class="cl-num">4</span><span>Wait 2-3 minutes for setup to complete</span></li>
        <li class="cl-item"><span class="cl-num">5</span><span>Your bot will start and your chat app will open</span></li>
      </ul>
      <div class="setup-box" style="margin-top:1.5rem">
        <h3>Troubleshooting</h3>
        <div class="faq-item"><div class="faq-q" onclick="toggleFAQ(this)">Permission denied<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div><div class="faq-a">If using the .command file, open Terminal and run: <code>chmod +x ~/Downloads/freeclaw-setup.command && open ~/Downloads/freeclaw-setup.command</code></div></div>
        <div class="faq-item"><div class="faq-q" onclick="toggleFAQ(this)">Setup fails with an error<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div><div class="faq-a">Check that you have an internet connection and at least 500MB of free disk space. Try running the command again.</div></div>
      </div>`;
  }
}

// ---------------------------------------------------------------------------
// Step 7: Success
// ---------------------------------------------------------------------------
function renderStep7() {
  const btn = document.getElementById('openChatBtn');
  const msg = document.getElementById('successMsg');
  switch (state.chatPlatform) {
    case 'telegram':
      btn.href = 'https://t.me/' + encodeURIComponent(state.telegram.botUsername);
      btn.textContent = 'Open Telegram';
      msg.textContent = 'Open Telegram and send your bot a message!';
      break;
    case 'discord':
      btn.href = 'https://discord.com/channels/@me';
      btn.textContent = 'Open Discord';
      msg.textContent = 'Open Discord and message your bot!';
      break;
    case 'whatsapp':
      btn.href = '#';
      btn.textContent = 'Open WhatsApp';
      btn.onclick = function(e) { e.preventDefault(); alert('Check your terminal for the QR code, then scan it with WhatsApp.'); };
      msg.textContent = 'Scan the QR code in your terminal with WhatsApp.';
      break;
    case 'slack':
      btn.href = 'https://app.slack.com';
      btn.textContent = 'Open Slack';
      msg.textContent = 'Open Slack and message your bot!';
      break;
  }
  const shareText = encodeURIComponent('Just set up my own AI chatbot in 10 minutes with FreeClaw by @Andrey__HQ - no coding needed. https://freeclaw.co');
  document.getElementById('tweetLink').href = 'https://twitter.com/intent/tweet?text=' + shareText;
}

function copyShareText(btn) {
  navigator.clipboard.writeText('Just set up my own AI chatbot in 10 minutes with FreeClaw by @Andrey__HQ - no coding needed. https://freeclaw.co').then(() => {
    const orig = btn.textContent;
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = orig, 2000);
  });
}

// ---------------------------------------------------------------------------
// Lightbox
// ---------------------------------------------------------------------------
function openLightbox(src) {
  document.getElementById('lightbox-img').src = src;
  document.getElementById('lightbox').classList.add('open');
}
function closeLightbox() {
  document.getElementById('lightbox').classList.remove('open');
}

// ---------------------------------------------------------------------------
// Input Sanitization
// ---------------------------------------------------------------------------
function escapeJSON(str) {
  return JSON.stringify(str).slice(1, -1);
}

function escapePowerShell(str) {
  return str.replace(/'/g, "''");
}

function toBase64(str) {
  return btoa(unescape(encodeURIComponent(str)));
}

function psWriteFileB64(filePath, b64) {
  return `powershell -NoProfile -ExecutionPolicy Bypass -Command "$b='${b64}';$t=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($b));[System.IO.File]::WriteAllText('${filePath}',$t,(New-Object System.Text.UTF8Encoding $false))"`;
}

function escapeShell(str) {
  return str.replace(/\\/g, '\\\\').replace(/"/g, '\\"').replace(/\$/g, '\\$').replace(/`/g, '\\`');
}

function containsInjection(str) {
  const patterns = [/;\s*(rm|curl|wget|bash|sh|eval|exec|del|format|shutdown)/i, /\$\(/, /`[^`]+`/, /\|\s*\w/];
  return patterns.some(p => p.test(str));
}

function sanitize(str) {
  if (containsInjection(str)) return str.replace(/[;&|`$(){}]/g, '');
  return str;
}

function generateRandomToken() {
  const chars = 'abcdef0123456789';
  let token = '';
  for (let i = 0; i < 48; i++) token += chars[Math.floor(Math.random() * chars.length)];
  return token;
}

// ---------------------------------------------------------------------------
// Build OpenClaw JSON config
// ---------------------------------------------------------------------------
function buildConfigJSON() {
  const p = providerMap[state.aiProvider];
  const config = {
    agents: { defaults: { workspace: '~/.openclaw/workspace', model: { primary: p.model } } },
    channels: {},
    plugins: { entries: {} },
    gateway: { port: 18789, mode: 'local', bind: 'loopback', auth: { mode: 'token', token: generateRandomToken() } }
  };
  switch (state.chatPlatform) {
    case 'telegram':
      config.channels.telegram = { enabled: true, botToken: sanitize(state.telegram.botToken), dmPolicy: 'open', allowFrom: ['*'] };
      config.plugins.entries.telegram = { enabled: true };
      break;
    case 'discord':
      config.channels.discord = { enabled: true, token: sanitize(state.discord.token) };
      config.plugins.entries.discord = { enabled: true };
      break;
    case 'whatsapp':
      config.channels.whatsapp = { dmPolicy: 'open', allowFrom: ['*'] };
      config.plugins.entries.whatsapp = { enabled: true };
      break;
    case 'slack':
      config.channels.slack = { enabled: true, botToken: sanitize(state.slack.botToken), appToken: sanitize(state.slack.appToken) };
      config.plugins.entries.slack = { enabled: true };
      break;
  }
  return JSON.stringify(config, null, 2);
}

function buildSOUL() {
  const selected = state.personalities.length > 0 ? state.personalities : ['friendly'];
  const traits = selected.map(k => personalities[k]).join('\n\n');
  let soul = `# SOUL.md - Who You Are\n\n## Identity\nYou are a personal AI assistant for ${sanitize(state.userName)}.\n\n## Core Behavior\n${traits}\n`;
  if (state.customInstructions.trim()) {
    soul += `\n## Special Instructions\n${sanitize(state.customInstructions)}\n`;
  }
  return soul;
}

function buildUSER() {
  return `# USER.md - About Your Human\n\n- **Name:** ${sanitize(state.userName)}\n- **What to call them:** ${sanitize(state.userName)}\n\n## Context\n\n*(Your bot will learn about you over time. You can edit this file to add more context.)*\n`;
}

function buildAGENTS() {
  return `# AGENTS.md - Your Workspace\n\nThis folder is home.\n\n## Every Session\n\nBefore doing anything else:\n1. Read SOUL.md - this is who you are\n2. Read USER.md - this is who you're helping\n\n## Safety\n\n- Don't share private info\n- Ask before taking external actions\n- When in doubt, ask\n`;
}

// ---------------------------------------------------------------------------
// Windows Script Generator
// ---------------------------------------------------------------------------
function generateWindowsScript() {
  const p = providerMap[state.aiProvider];
  const configB64 = toBase64(buildConfigJSON());
  const soulB64 = toBase64(buildSOUL());
  const userB64 = toBase64(buildUSER());
  const agentsB64 = toBase64(buildAGENTS());
  const apiKey = sanitize(state.apiKey);

  let openCmd = '';
  switch (state.chatPlatform) {
    case 'telegram': openCmd = `start https://t.me/${sanitize(state.telegram.botUsername)}`; break;
    case 'discord': openCmd = 'start https://discord.com/channels/@me'; break;
    case 'whatsapp': openCmd = 'echo Please scan the QR code shown above with WhatsApp.'; break;
    case 'slack': openCmd = 'start https://app.slack.com'; break;
  }

  return `@echo off
setlocal EnableExtensions EnableDelayedExpansion
chcp 65001 >nul 2>&1
title FreeClaw Setup

echo.
echo   ___              ___ _
echo  / __\\ __ ___  ___/ __\\ ^| __ ___      __
echo / _\\^| '__/ _ \\/ _ \\ /  ^| ^|/ _\` \\ \\ /\\ / /
echo / /  ^| ^| ^|  __/  __/ /\\_^| ^| (_^| ^\\ V  V /
echo \\/   ^|_^|  \\___^|\\___\\____/_^|\\__,_^| \\_/\\_/
echo.
echo   Your AI chatbot, running on your computer.
echo.

set "FREECLAW_HOME=%USERPROFILE%\\freeclaw"
set "OPENCLAW_HOME=%USERPROFILE%\\.openclaw"
set "NODE_VER=22.13.0"

:: Check if already installed
if exist "%FREECLAW_HOME%\\node\\node.exe" (
    echo FreeClaw is already installed at %FREECLAW_HOME%
    set /p "REINSTALL=Reinstall? (Y/N): "
    if /i not "!REINSTALL!"=="Y" goto :START_BOT
    echo Reinstalling...
)

:: Step 1: Download Node.js
echo.
echo [1/6] Downloading Node.js %NODE_VER%...
mkdir "%FREECLAW_HOME%" 2>nul
del "%TEMP%\\freeclaw-node.zip" 2>nul
powershell -NoProfile -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12; $ProgressPreference='SilentlyContinue'; try { Invoke-WebRequest -Uri 'https://nodejs.org/dist/v%NODE_VER%/node-v%NODE_VER%-win-x64.zip' -OutFile '%TEMP%\\freeclaw-node.zip' -UseBasicParsing } catch { Write-Host 'DOWNLOAD_FAILED'; exit 1 }"
if errorlevel 1 (
    echo ERROR: Failed to download Node.js. Check your internet connection.
    pause & exit /b 1
)
if not exist "%TEMP%\\freeclaw-node.zip" (
    echo ERROR: Failed to download Node.js. File not found after download.
    pause & exit /b 1
)
echo       Done.

:: Step 2: Download Git
echo [2/6] Downloading Git...
del "%TEMP%\\freeclaw-git.zip" 2>nul
powershell -NoProfile -ExecutionPolicy Bypass -Command "[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12; $ProgressPreference='SilentlyContinue'; try { Invoke-WebRequest -Uri 'https://github.com/git-for-windows/git/releases/download/v2.47.1.windows.1/MinGit-2.47.1-64-bit.zip' -OutFile '%TEMP%\\freeclaw-git.zip' -UseBasicParsing } catch { Write-Host 'DOWNLOAD_FAILED'; exit 1 }"
if errorlevel 1 (
    echo ERROR: Failed to download Git. Check your internet connection.
    pause & exit /b 1
)
if not exist "%TEMP%\\freeclaw-git.zip" (
    echo ERROR: Failed to download Git. File not found after download.
    pause & exit /b 1
)
echo       Done.

:: Step 3: Extract
echo [3/6] Setting up...
powershell -NoProfile -ExecutionPolicy Bypass -Command "$ErrorActionPreference='Stop'; $ProgressPreference='SilentlyContinue'; if (Test-Path '%FREECLAW_HOME%\\node') { Remove-Item '%FREECLAW_HOME%\\node' -Recurse -Force }; Expand-Archive -Path '%TEMP%\\freeclaw-node.zip' -DestinationPath '%FREECLAW_HOME%\\node-temp' -Force; Get-ChildItem '%FREECLAW_HOME%\\node-temp\\node-v%NODE_VER%-win-x64' | Move-Item -Destination '%FREECLAW_HOME%\\node' -Force; Remove-Item '%FREECLAW_HOME%\\node-temp' -Recurse -Force -ErrorAction SilentlyContinue"
if errorlevel 1 (
    echo ERROR: Failed to extract Node.js. The download may be corrupt - please try again.
    pause & exit /b 1
)
powershell -NoProfile -ExecutionPolicy Bypass -Command "$ErrorActionPreference='Stop'; $ProgressPreference='SilentlyContinue'; if (Test-Path '%FREECLAW_HOME%\\git') { Remove-Item '%FREECLAW_HOME%\\git' -Recurse -Force }; Expand-Archive -Path '%TEMP%\\freeclaw-git.zip' -DestinationPath '%FREECLAW_HOME%\\git' -Force"
if errorlevel 1 (
    echo ERROR: Failed to extract Git. The download may be corrupt - please try again.
    pause & exit /b 1
)
del "%TEMP%\\freeclaw-node.zip" 2>nul
del "%TEMP%\\freeclaw-git.zip" 2>nul
echo       Done.

:: Set PATH
set "PATH=%FREECLAW_HOME%\\node;%FREECLAW_HOME%\\git\\cmd;%PATH%"

:: Step 4: Install OpenClaw
echo [4/6] Installing OpenClaw (this may take a minute)...
call "%FREECLAW_HOME%\\node\\npm.cmd" install -g openclaw@latest --no-fund --no-audit >"%FREECLAW_HOME%\\npm-log.txt" 2>&1
if errorlevel 1 (
    echo ERROR: Failed to install OpenClaw. Check %FREECLAW_HOME%\\npm-log.txt
    pause & exit /b 1
)
echo       Done.

:: Step 5: Configure
echo [5/6] Configuring your bot...
mkdir "%OPENCLAW_HOME%" 2>nul
mkdir "%OPENCLAW_HOME%\\workspace" 2>nul

:: Write config files using Base64 to avoid batch/PowerShell quoting issues
${psWriteFileB64('%OPENCLAW_HOME%\\openclaw.json', configB64)}
${psWriteFileB64('%OPENCLAW_HOME%\\workspace\\SOUL.md', soulB64)}
${psWriteFileB64('%OPENCLAW_HOME%\\workspace\\USER.md', userB64)}
${psWriteFileB64('%OPENCLAW_HOME%\\workspace\\AGENTS.md', agentsB64)}
echo       Done.

:: Step 6: Activate
echo [6/6] Starting your bot...

:: Run onboard for auth and daemon install
call "%FREECLAW_HOME%\\node\\npx.cmd" openclaw onboard --non-interactive --accept-risk --install-daemon --auth-choice ${p.authChoice} ${p.authFlag} "${apiKey}" --skip-channels --skip-skills --skip-health --workspace "%OPENCLAW_HOME%\\workspace" >"%FREECLAW_HOME%\\onboard-log.txt" 2>&1

:: Auto-fix any config issues (enables channel plugin)
call "%FREECLAW_HOME%\\node\\npx.cmd" openclaw doctor --fix >"%FREECLAW_HOME%\\doctor-log.txt" 2>&1

:: Create Start.bat
(
echo @echo off
echo set "PATH=%FREECLAW_HOME%\\node;%FREECLAW_HOME%\\git\\cmd;%%PATH%%"
echo title FreeClaw
echo echo FreeClaw is running. Press Ctrl+C to stop.
echo call "%FREECLAW_HOME%\\node\\npx.cmd" openclaw gateway
echo pause
) > "%FREECLAW_HOME%\\Start.bat"

:: Open chat
${openCmd}

echo.
echo ============================================
echo   FreeClaw setup complete!
echo   Your bot is running.
echo ============================================
echo.
echo To restart your bot later, run:
echo   %FREECLAW_HOME%\\Start.bat
echo.
pause
exit /b 0

:START_BOT
set "PATH=%FREECLAW_HOME%\\node;%FREECLAW_HOME%\\git\\cmd;%PATH%"
call "%FREECLAW_HOME%\\node\\npx.cmd" openclaw gateway
pause
`;
}

// ---------------------------------------------------------------------------
// macOS Script Generator
// ---------------------------------------------------------------------------
function generateMacScript() {
  const p = providerMap[state.aiProvider];
  const configJSON = buildConfigJSON();
  const soulMD = buildSOUL();
  const userMD = buildUSER();
  const agentsMD = buildAGENTS();
  const apiKey = sanitize(state.apiKey);

  let openCmd = '';
  switch (state.chatPlatform) {
    case 'telegram': openCmd = `open "https://t.me/${sanitize(state.telegram.botUsername)}"`; break;
    case 'discord': openCmd = 'open "https://discord.com/channels/@me"'; break;
    case 'whatsapp': openCmd = 'echo "Please scan the QR code shown above with WhatsApp."'; break;
    case 'slack': openCmd = 'open "https://app.slack.com"'; break;
  }

  return `#!/bin/bash
set -e

# FreeClaw Setup - macOS

RED='\\033[0;31m'
GREEN='\\033[0;32m'
BLUE='\\033[0;34m'
PURPLE='\\033[0;35m'
BOLD='\\033[1m'
NC='\\033[0m'

clear
echo ""
echo -e "\${PURPLE}\${BOLD}"
echo "   ___              ___ _"
echo "  / __\\\\ __ ___  ___/ __\\\\ | __ ___      __"
echo " / _\\\\| '__/ _ \\\\/ _ \\\\ /  | |/ _\\\` \\\\ \\\\ /\\\\ / /"
echo "/ /  | | |  __/  __/ /\\\\_| | (_| |\\\\ V  V /"
echo "\\\\/   |_|  \\\\___|\\\\___|\\\\____/_|\\\\__,_| \\\\_/\\\\_/"
echo -e "\${NC}"
echo "  Your AI chatbot, running on your computer."
echo ""

FREECLAW_HOME="$HOME/freeclaw"
OPENCLAW_HOME="$HOME/.openclaw"
NODE_VER="22.13.0"

# Detect architecture
ARCH=$(uname -m)
if [ "$ARCH" = "arm64" ]; then
  NODE_URL="https://nodejs.org/dist/v\${NODE_VER}/node-v\${NODE_VER}-darwin-arm64.tar.gz"
else
  NODE_URL="https://nodejs.org/dist/v\${NODE_VER}/node-v\${NODE_VER}-darwin-x64.tar.gz"
fi

# Check if already installed
if [ -f "$FREECLAW_HOME/node/bin/node" ]; then
  echo "FreeClaw is already installed."
  read -p "Reinstall? (y/N): " REINSTALL
  if [ "$REINSTALL" != "y" ] && [ "$REINSTALL" != "Y" ]; then
    export PATH="$FREECLAW_HOME/node/bin:$PATH"
    exec npx openclaw gateway
  fi
fi

# Step 1: Download Node.js
echo -e "\${BLUE}[1/5]\${NC} Downloading Node.js \${NODE_VER} (\${ARCH})..."
mkdir -p "$FREECLAW_HOME"
curl -fsSL "$NODE_URL" -o "/tmp/freeclaw-node.tar.gz" || {
  echo -e "\${RED}ERROR: Failed to download Node.js. Check your internet connection.\${NC}"
  exit 1
}
echo "      Done."

# Step 2: Extract
echo -e "\${BLUE}[2/5]\${NC} Setting up..."
rm -rf "$FREECLAW_HOME/node"
mkdir -p "$FREECLAW_HOME/node"
tar -xzf "/tmp/freeclaw-node.tar.gz" -C "$FREECLAW_HOME/node" --strip-components=1
rm -f "/tmp/freeclaw-node.tar.gz"
export PATH="$FREECLAW_HOME/node/bin:$PATH"
echo "      Done."

# Step 3: Install OpenClaw
echo -e "\${BLUE}[3/5]\${NC} Installing OpenClaw (this may take a minute)..."
npm install -g openclaw@latest --no-fund --no-audit > "$FREECLAW_HOME/npm-log.txt" 2>&1 || {
  echo -e "\${RED}ERROR: Failed to install OpenClaw. Check $FREECLAW_HOME/npm-log.txt\${NC}"
  exit 1
}
echo "      Done."

# Step 4: Configure
echo -e "\${BLUE}[4/5]\${NC} Configuring your bot..."
mkdir -p "$OPENCLAW_HOME/workspace"

cat > "$OPENCLAW_HOME/openclaw.json" << 'FREECLAW_CONFIG_END'
${configJSON}
FREECLAW_CONFIG_END

cat > "$OPENCLAW_HOME/workspace/SOUL.md" << 'FREECLAW_SOUL_END'
${soulMD}
FREECLAW_SOUL_END

cat > "$OPENCLAW_HOME/workspace/USER.md" << 'FREECLAW_USER_END'
${userMD}
FREECLAW_USER_END

cat > "$OPENCLAW_HOME/workspace/AGENTS.md" << 'FREECLAW_AGENTS_END'
${agentsMD}
FREECLAW_AGENTS_END

# Remove quarantine
xattr -rd com.apple.quarantine "$FREECLAW_HOME" 2>/dev/null || true
xattr -rd com.apple.quarantine "$OPENCLAW_HOME" 2>/dev/null || true
echo "      Done."

# Step 5: Activate
echo -e "\${BLUE}[5/5]\${NC} Starting your bot..."

npx openclaw onboard --non-interactive --accept-risk \\
  --install-daemon \\
  --auth-choice ${p.authChoice} ${p.authFlag} "${escapeShell(apiKey)}" \\
  --skip-channels --skip-skills --skip-health \\
  --workspace "$OPENCLAW_HOME/workspace" > "$FREECLAW_HOME/onboard-log.txt" 2>&1 || true

# Auto-fix any config issues (enables channel plugin)
npx openclaw doctor --fix > "$FREECLAW_HOME/doctor-log.txt" 2>&1 || true

# Create start script
cat > "$FREECLAW_HOME/start.sh" << 'FREECLAW_START_END'
#!/bin/bash
export PATH="$HOME/freeclaw/node/bin:$PATH"
echo "FreeClaw is running. Press Ctrl+C to stop."
npx openclaw gateway
FREECLAW_START_END
chmod +x "$FREECLAW_HOME/start.sh"

# Open chat
${openCmd}

echo ""
echo -e "\${GREEN}============================================\${NC}"
echo -e "\${GREEN}  FreeClaw setup complete!\${NC}"
echo -e "\${GREEN}  Your bot is running.\${NC}"
echo -e "\${GREEN}============================================\${NC}"
echo ""
echo "To restart your bot later, run:"
echo "  $FREECLAW_HOME/start.sh"
echo ""
`;
}

// ---------------------------------------------------------------------------
// Download
// ---------------------------------------------------------------------------
function downloadScript() {
  let content, filename, mime;
  if (state.os === 'windows') {
    content = generateWindowsScript();
    filename = 'freeclaw-setup.bat';
    mime = 'application/bat';
    content = content.replace(/\n/g, '\r\n');
  } else {
    content = generateMacScript();
    filename = 'freeclaw-setup.command';
    mime = 'text/plain';
  }
  const blob = new Blob([content], { type: mime });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}
  </script>
</body>
</html>
